<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <base target="_top">
    <!--font awesome-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sarabun">
    <!-- Font Awesome CSS -->
    <script src="https://kit.fontawesome.com/6a972cf3a7.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"
        integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ=="
        crossorigin="anonymous"></script>
    <!-- CSS only -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!--ชุดสี bootstrap5-->
    <link href="https://ltschool.web.app/css/Bootstrapcolor.css" rel="stylesheet" type="text/css">
    <style type='text/css'>
        @font-face {
            font-family: 'Sarabun';
        }

        body {
            font-family: 'Sarabun' !important;
        }

        a {
            color: #000;
            text-decoration: none;
        }
        html,body{
        min-height:100vh; 
        /* display: grid; */
        place-items: center;
        background: url("https://drive.google.com/uc?id=1qLkFdvHYQNGwNn131OPZejACQs3_HGnW") no-repeat center center fixed;
        /* -webkit-background-size: cover;
        -moz-background-size: cover;
        -o-background-size: cover;
        background-size: cover;   */
      }
    </style>

</head>

<body>

    <div class="container">
        <div class="row">
            <div class="col-md-6 mx-auto">
                <div class="card text-center">
                    <!-- <div class="card-body"> -->
                    <div class="card border-blue-500">
                        <img src="https://drive.google.com/uc?id=1SVYEAObkRNw0A3ACx0HwFbqshcfKBlKp" width="35%" style="margin-left:auto ; margin-right: auto;">
                        <h5 class="card-header text-white bd-blue-500"><i class="far fa-address-card mr-3"></i>
                             ระบบตรวจสอบค่าแรง</h5>
                        <div class="card-body">

                            <!-- <input class="form-control form-control" type="text" id="idStudent" style="text-align: center;"placeholder="พิมพ์หมายเลขบัตรประชาชน" maxlength="13" required> -->


                            <select class="form-select form-select-lg mb-3" aria-label=".form-select-lg example"
                                name="cars" id="idStudent">

                                <option value="-">กรุณาเลือกรายชื่อ</option>

                                <option value="1">โอ</option>
                                <option value="2">นัน</option>
                                <option value="3">วิน</option>
                                <option value="4">เก้</option>
                                <option value="5">อู</option>
                                <option value="6">โทน</option>
                                <option value="7">เหน่ง</option>
                                <option value="8">หม่ำ</option>
                                <option value="9">ซู่</option>
                                <option value="10">คัย</option>
                                <option value="11">ผิว</option>
                                <option value="12">ธนยง</option>
                                <option value="13">อัญชลี</option>
                                <option value="14">พัฒ</option>

                            </select>
                            <br><br>

                            <div class="row">
                                <div class="col-md-6 mx-auto" style="padding-bottom: 40px;">
                                    <center>
                                        <button type="button" class="btn bd-blue-500 text-white mt-3" id="search-btn" onclick="findCode()">
                                            ตรวจสอบ</button>
                    
                                        <button class="btn bd-blue-500  mt-3" type="button" disabled id="btn2" style="display:none">
                                            <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                                            กำลังตรวจสอบ...
                                        </button>
                                    </center>
                    
                                    <!-- Button trigger modal -->
                                    <button type="button" class="btn btn-primary" id="btnmodal" data-bs-toggle="modal"
                                        data-bs-target="#staticBackdrop" style="display:none">
                                        modal
                                    </button>
                    
                                    <!-- Modal -->
                                    <div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false"
                                        tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header bd-pink-500">
                                                    <h5 class="modal-title" id="staticBackdropLabel"><i class="fas fa-user-graduate"></i>
                                                        รายละเอียดค่าแรง</h5>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                        aria-label="Close"></button>
                                                </div>
                                                <div class="modal-body">
                    
                                                    <div id="search"> </div>
                    
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                    
                                </div>

                                <div class="alert alert-warning text-center font-weight-bold h5" role="alert" >
                                    <span style="display:show;">:  อัพเดตข้อมูลเมื่อ  :  25 กุมภาพันธ์ 2566
                                      
                                    </span>
                                    
                                    
                                  </div>

                            <h6 style="padding-top: 40px;">© 2023 ธีรชานนท์ พวงเงิน </h6>


                            <div id="output" class="mt-3"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        


            <script>
                function findCode() {
                    document.getElementById('search').innerHTML = ''
                    var code = document.getElementById("idStudent").value;
                    // document.getElementById("loader").style.visibility = "visible"; 
                    $('#search-btn').hide()
                    $('#btn2').show()

                    if (document.getElementById('idStudent').value == "") {
                        document.getElementById("output").innerHTML = "<div class='alert alert-danger' role='alert'>กรุณาพิมพ์หมายเลขบัตรประชาชน</div>";
                        setTimeout(function () {
                            document.getElementById('output').innerHTML = "";
                        }, 1500);
                        $('#search-btn').show()
                        $('#btn2').hide()
                    } else {
                        google.script.run.withSuccessHandler(updateData).getCode(code);
                    }
                }
                function updateData(data) {
                    if (data == '<center>*ไม่พบข้อมูล<br><img src="https://ltschool.web.app/pic/falseok.gif" width="200" height="200"></center>') {
                        Swal.fire({
                            position: 'center',
                            icon: 'error',
                            title: 'เสียใจด้วย..ไม่พบข้อมูลของคุณ',
                            showConfirmButton: false,
                            timer: 1500
                        })
                        document.getElementById("search").innerHTML = data;
                        $('#search-btn').show()
                        $('#btn2').hide()
                        M.updateTexfields();
                    } else {
                        // Swal.fire({
                        //   position: 'center',
                        //   icon: 'success',
                        //   title: 'ยินดีด้วย..พบข้อมูลของคุณ',
                        //   showConfirmButton: false,
                        //   timer: 2000
                        // })
                        document.getElementById('idStudent').value = ''
                        document.getElementById("search").innerHTML = data;
                        $('#search-btn').show()
                        $('#btn2').hide()
                        $('#btnmodal').click()

                        M.updateTexfields();
                    }
                }
                window.onload = function () { document.getElementById("search-btn").style.visibility = "visible" }
            </script>
            <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"
                integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB"
                crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"
                integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13"
                crossorigin="anonymous"></script>
            <script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
</body>

</html>